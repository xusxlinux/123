#### bind9主配置文件
``` shell
# named需要修改的配置文件
[root@hdss7-11 ~]# vim /etc/named.conf
13         listen-on port 53 { 10.4.7.11; };  // 本机地址
14         listen-on-v6 port 53 { ::1; };     // 删除这行

20         allow-query     { any; };          // 允许本机的DNS帮你查询
21         forwarders      { 10.4.7.1; };     // BIND 8.2后的新特性 区域转发

22         allow-transfer  { 10.4.7.11; };    // 完全区域传送
23         also-notify     { 10.4.7.12; };    // 主动通知从（slave）服务器进行更新

35         recursion yes;                     // 企业内网DNS使用recursion选项
37         dnssec-enable yes;                 // 打开该配置
38         dnssec-validation yes;             // 如果外面的域名加上DNSSEC的签名,我们通过这台DNS服务器递归查询的时候,可以把签名查出来


# 检查 /etc/named.conf 配置文件
[root@hdss7-11 ~]# named-checkconf /etc/named.conf
```

#### 启动named服务
``` shell
[root@hdss7-11 ~]# systemctl start named
[root@hdss7-11 ~]# systemctl enable named
```

#### 验证是否启动成功
``` shell
# 查看53端口是否启动成功
[root@hdss7-11 ~]# netstat -lntup | grep 53


# 修改虚拟机网关, 粘贴如下配置
[root@hdss7-11 ~]# cat /etc/resolv.conf
# 加上辅助DNS的IP实现高可用 search作用：短域名
# Generated by NetworkManager
search localhost chain.com
nameserver 10.4.7.11
nameserver 10.4.7.12


# 查看是否成功了
[root@hdss7-11 ~]# ping www.baidu.com
```

#### DNS自定义区域配置文件
- 也可以配置在自定义的其他文件内, 并在named.conf里include  
- 文件的权限, 属主root, 属组named, 权限640

``` shell
# 自定义区域配置文件, 粘贴如下配置
[root@hdss7-11 ~]# vim /etc/named.rfc1912.zones

# 主机域配置
zone "host.com" IN {
        type  master;                                // 自定义区域类型
        file  "host.com.zone";                       // 绝对或相对路径
        allow-update { 10.4.7.11;10.4.7.12; };       // 是否允许动态更新
};


# 检查配置
[root@hdss7-11 ~]# named-checkconf
```

#### 自定义区域数据库文件
``` shell
# 主机域(不能解析到互联网上, 只是我们做的一个假域)  粘贴如下配置
[root@hdss7-11 ~]# vim /var/named/host.com.zone 

$ORIGIN host.com.
$TTL 600             ; 10 minutes
@                    IN  SOA  dns.host.com. dnsadmin.host.com. (; SOA其实授权,有且只能有一条,并且要写在最前面
                                    2020101000 ; serial
                                    10800      ; refresh (3 hours)
                                    900        ; retry   (15 minutes)
                                    604800     ; expire  (1 week)
                                    86400      ; minimum (1 day)
                                    )
                     IN  NS   dns.host.com.
$TTL 60              ; 1 minute
$ORIGIN host.com.
dns                  IN  A    10.4.7.11
HDSS7-11             IN  A    10.4.7.11
HDSS7-12             IN  A    10.4.7.12
HDSS7-21             IN  A    10.4.7.21
HDSS7-22             IN  A    10.4.7.22
HDSS7-200            IN  A    10.4.7.200
```

#### 每一步都要check检查是否配置正确
``` shell
# 配置文件权限
[root@hdss7-11 ~]# chown root.named /var/named/host.com.zone
[root@hdss7-11 ~]# chmod 640 /var/named/host.com.zone

# 检查主机域配置文件是否正确
[root@hdss7-11 ~]# named-checkzone host.com /var/named/host.com.zone
```

#### 验证主机名能否解析出 IP地址
``` shell
[root@hdss7-11 ~]# dig -t A hdss7-11.host.com +short
[root@hdss7-11 ~]# dig -t A hdss7-11.host.com
```
